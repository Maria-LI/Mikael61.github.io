<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
		.note { clear : left ;
		margin : 1em 15em 1em 15em ;
		border : solid black 1px ;
		font-size : 0.9em ;
		font-style : italic
		}
		</style>
<meta name="generator" content="HTML Tidy, see www.w3.org" />
<title>XML-&ouml;vning 2</title>
</head>
<body>
<h2 style=
"font-family : Garamond; font-variant : small-caps; margin-left: 80px; margin-right: 30px; color : red; background-color : FFFFCC;">
Reviderad HT09</h2>

<h1 style=
"font-family : Garamond; font-variant : small-caps; color : navy; background-color : silver; margin-left : 80px; margin-right : 80px;">
XML - uppgift 2</h1>

<h2 style=
"font-family : Garamond; font-variant : small-caps; margin-left: 80px; color : navy">
Document Type Definition</h2>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Du skall nu skriva en DTD till det dokument du skapade i uppgift
<a style="font-family : verdana; font-size : 10pt; color : red;"
href="uppgift1.htm">1</a>. DTDer generaliserar strukturen i en mängd dokument
och det förtjänar att understrykas att det är lite avigt att konstruera ett
enda dokument för att formalisera dess struktur i form av en DTD, men vi gör det
här av pedagogiska skäl. En mer rationell metod är förstås att först skriva en
DTD och därefter dokumenten som är konforma med denna.
(Se Ray (2004, s. 113-121) för en mer utvecklad genomgång av DTDer) 
</p>

<p  style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
I korthet, vad du skall göra när du skriver en DTD, är att <em>deklarera varje
element och attribut</em> som du använt (eller avser att använda) i ditt
xml-dokument och bestämma <em>vad varje element får innehålla</em> --- dvs, i
XML-terminologi, en innehållsmodell (<em>content model</em>) för varje element

</p>


<p style=
"font-family : 'Times New Roman'; font-size : 10pt; font-weight : bold; color : silver; float : left;">
dtd-filen</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Det f&ouml;rsta du kan g&ouml;ra &auml;r att &ouml;ppna ett nytt
f&ouml;nster i Notepad / Anteckningar (eller EditiX, som har visst stöd för
DTD-notation). Precis som n&auml;r det
g&auml;ller xml-filer och formatmallar (i CSS eller XSL)
r&auml;cker det bra med en enkel textredigerare f&ouml;r att
skapa en dtd-fil. DTDn beh&ouml;ver inte, till skillnad från XML-filer,
inledas med n&aring;gon
instruktion som anger att det &auml;r en DTD, det r&auml;cker att
du sparar den (l&auml;mpligtvis i den mapp d&auml;r du sparade
filen i uppgift 1) som en fil med extensionen <code>.dtd</code>, t ex
<code>xmltest.dtd</code></p>

<p style=
"font-family : 'Times New Roman'; font-size : 10pt; font-weight : bold; color : silver; float : left;">
element type<br />
declaration</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Man anv&auml;nder konstruktionen &lt;!ELEMENT &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &gt; f&ouml;r att
deklarera ett element. Direkt efter ELEMENT skriver man namnet
p&aring; elementet och d&auml;refter en uppgift om vad det
f&aring;r inneh&aring;lla (innehållsmodellen).</p>
<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Vi b&ouml;rjar med att deklarera rotelementet <code>bibliography</code>
(vilket du naturligtvis ers&auml;tter med det rotelement du har
anv&auml;nt):</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!ELEMENT bibliography ANY&gt;</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Nyckelordet ANY anger att elementet kan inneh&aring;lla
b&aring;de text och andra element. 
</p>
<p class="note">
ANY är ingen bra innehållsmodell, därför att den inte begränsar innehållet alls.
DTDer med endast ANY som innehållsmodeller är meningslösa. Använd ANY mycket
sparsamt.
</p>
<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Om
ett element f&aring;r inneh&aring;lla andra element (dvs
l&auml;ngre ner i tr&auml;dstrukturen) anger man namnet p&aring;
elementet/elementen inom parentes. Skall de f&ouml;rekomma i en
s&auml;rskild ordning anv&auml;nder man kommatecken mellan
elementnamnen, annars s&auml;rskiljs de med ett lodr&auml;tt streck
(|, infogas med [AltGr - &lt;]). Ett tomt element
har nyckelordet EMPTY. OM vi, t ex, vill deklarera en innehållsmodell för ett
element <code>shortBibRef</code> som i angiven ordning skall innehålla, ett
författarnamn eller ett redaktörsnamn, ett publikationsår och en titel, så är
följande modell tänkbar:
</p>
<p style="font-family : arial; font-size : 10pt; margin-left: 130px; margin-right : 100px;">&lt;!ELEMENT shortBibRef ((author|editor),year,title) &gt;
</p>
		<p style="font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;"> 
		Observera att vi här inte tillåter både författare och redaktör
		och att du kan bygga upp innehållsmodeller av mindre undermodeller med hjälp
		av parenteser. Om du vill tillåta både författare och redaktör så kan du lägga till
		ett <code>+</code> efter den första högerparentesen. 
</p>
		<p style="font-family : arial; font-size : 10pt; margin-left: 130px; margin-right : 100px;">&lt;!ELEMENT shortBibRef ((author|editor)+,year,title) &gt;
</p>
<p style="font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Man kan alltså &auml;ven ange hur m&aring;nga
g&aring;nger elementet f&aring;r f&ouml;rekomma:</p>

<dl style=
"font-family : verdana; font-size : 10pt; margin-left: 130px; margin-right : 100px;">
<dt>? om det &auml;r valfritt om elementet skall f&ouml;rekomma,
men det f&aring;r endast f&ouml;rekomma 1 g&aring;ng</dt>

<dt>* om det &auml;r valfritt om elementet skall f&ouml;rekomma,
och det f&aring;r f&ouml;rekomma valfritt antal g&aring;nger</dt>

<dt>+ om elementet f&aring;r f&ouml;rekomma valfritt antal g&aring;nger, men m&aring;ste f&ouml;rekomma minst en (1)
g&aring;ng</dt>
</dl>
<p style="font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Om inget av dessa tecken förekommer skall elementet förekomma exakt en gång. Här
förljer en tänkbar innehållsmodell för elementet <code>book</code> i vårt tidigare exempel.
</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!ELEMENT bibliography ANY&gt;<br />
&lt;!ELEMENT book (author*, title+, place+, publisher*, year,
pages, edition?, ISBN)&gt;</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
I v&aring;r v&auml;ldigt enkla tr&auml;dstruktur inneh&aring;ller
de &ouml;vriga elementen enbart alfa-numeriska tecken. Det anger
vi med hj&auml;lp av #PCDATA, vilket st&aring;r f&ouml;r
<i>parsed character data</i> och inneb&auml;r att elementet
f&aring;r ha text och teckenkoder.<br />
(Vi hoppar f&ouml;r tillf&auml;llet &ouml;ver det tomma elementet
som du eventuellt har tillf&ouml;rt din xml-fil. Ta
tempor&auml;rt bort det fr&aring;n xml-filen, s&aring; att det
inte st&auml;ller till besv&auml;r vid valideringen. Hur tomma
element behandlas i DTD:n g&aring;s igenom i &ouml;vning <a
style="font-family : verdana; font-size : 10pt; color : red;"
href="uppgift3.htm">3</a>.)<br />
Obs! att f&ouml;rkortningen i exemplet nedan - (...) - &auml;r
just en f&ouml;rkortning och inget annat. Detta &auml;r
allts&aring; inte n&aring;got som du skall skriva in i din
DTD.</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!ELEMENT bibliography ANY&gt;<br />
&lt;!ELEMENT book (author*, title+, place+, publisher*, year,
pages, edition?, ISBN)&gt;<br />
&lt;!ELEMENT author (#PCDATA)&gt;<br />
&lt;!ELEMENT title (#PCDATA)&gt;<br />
(...)<br />
&lt;!ELEMENT ISBN (#PCDATA)&gt;</p>

<p style=
"font-family : 'Times New Roman'; font-size : 10pt; font-weight : bold; color : silver; float : left;">
attribute-list<br />
declaration</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Vi har ju &auml;ven anv&auml;nt oss av minst ett attribut -
language - som ocks&aring; beh&ouml;ver deklareras. Det g&ouml;r
man med hj&auml;lp av konstruktionen &lt;!ATTLIST &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &gt;. Efter ATTLIST
skriver man namnet p&aring; det element som kan ta attributet,
f&ouml;ljt av namnet p&aring; attributet. Har man flera
m&ouml;jliga attribut till samma element s&aring; kan man skriva
det nya attributet p&aring; en ny rad. D&auml;refter f&ouml;ljer
ett nyckelord som betecknar attributets typ. Det enklaste &auml;r att ange
CDATA - ett slags motsvarighet till #PCDATA. Du kan v&auml;lja
att ha viss kontroll &ouml;ver vilka v&auml;rden som skall vara
m&ouml;jliga. F&ouml;r att ange ett default-v&auml;rde
s&auml;tter du det inom citationstecken. Du kan &auml;ven
best&auml;mma vilka v&auml;rden som skall vara m&ouml;jliga genom
att ange alternativen &aring;tskilda med ett lodr&auml;tt streck
(|) -- i sådana fall deklareras inte attributtyp. 
F&ouml;r att ange att ett attribut-v&auml;rde m&aring;ste
f&ouml;rekomma, men utan att best&auml;mma vilket skriver du
#REQUIRED.</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!ATTLIST title language (svenska | engelska | tyska |
franska) "svenska"&gt;</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
I exemplet ovan m&aring;ste man allts&aring; v&auml;lja
n&aring;got av v&auml;rdena svenska, engelska, tyska eller
franska och om inget attribut anges utg&aring;r XML-tolken
fr&aring;n att det &auml;r svenska som g&auml;ller. I exemplet
nedan &auml;r det d&auml;remot valfritt vilket v&auml;rde som
v&auml;ljs, men attributet &auml;r obligatoriskt.</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!ATTLIST title language CDATA #REQUIRED&gt;</p>

<p class="note">Du får inte deklarera element och attribut mer än en gång i en DTD.</p>

<h2 style=
"font-family : Garamond; font-variant : small-caps; margin-left: 80px; color : navy">
L&auml;nka till din DTD</h2>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
F&ouml;r att du skall ha n&aring;gon nytta av din DTD skall du nu
l&auml;nka fr&aring;n din xml-fil till DTDn. XML-filen blir
d&aring; <i>giltig</i>(valid) eller ogiltig, beroende på om din XML-instans är konform med din DTD eller inte. 
Detta &aring;stadkommer du genom
att &ouml;ppna XML-filen och efter XML-deklarationen infoga en
&lt;!DOCTYPE&gt;-deklaration:</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!DOCTYPE bibliography SYSTEM "xmltest.dtd"&gt;</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Efter !DOCTYPE komer allts&aring; namnet p&aring; rotelementet i
din XML-fil, f&ouml;ljt av nyckelordet SYSTEM och
s&ouml;kv&auml;gen till DTDn inom citationstecken.</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Du kan ocks&aring; f&ouml;r s&auml;kerhets skull i
XML-deklarationen l&auml;gga till ett nytt attribut,
n&auml;mligen <i>standalone</i> som ges v&auml;rdet "no".</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;?xml version="1.0" encoding="utf-8"
standalone="no"?&gt;</p>

<p class="note">Observera att det skall vara samma teckenkodning för DTDn som för XML-filen (utf-8 eller iso-8859-1)</p>

<h2 style=
"font-family : Garamond; font-variant : small-caps; margin-left: 80px; color : navy">
Validera XML-dokumentet</h2>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Du kan nu kontrollera din fil i en <i>validerande</i> XML-tolk
(XML-behandlare), dvs en tolk som &auml;ven kontrollerar att din
XML-kod f&ouml;ljer en DTD korrekt. En XML-tolk finns p&aring;
Brown University.<br />
Validerande XML-tolk <a style=
"font-family : verdana; font-size : 10pt; color : red;" href=
"http://www.stg.brown.edu/service/xmlvalid/">http://www.stg.brown.edu/service/xmlvalid/</a>
<span style="color : red">(Denna fungerar för tillfället inte. Använd
  <a href="http://www.validome.org/xml">http://www.validome.org/xml</a>) i stället. </span> Använder du EditiX här så är det fullt tillräckligt att kontrollera syntaxen med Ctrl+k.</p>

<p style=
"font-family : 'Times New Roman'; font-size : 10pt; font-weight : bold; color : silver; float : left;">
intern DTD</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Nu vid &ouml;vningstillf&auml;llet kan du antingen spara filerna
p&aring; din webbarea och f&ouml;lja instruktionerna ovan eller
utnyttja den funktion i validatorn som l&aring;ter oss validera
en fil som ligger sparad lokalt (p&aring; en h&aring;rddisk,
ett USB-minne el dyl). Nackdelen med detta &auml;r emellertid att
validatorn d&aring; bara h&auml;mtar hem <i>en</i> fil och
allts&aring; missar DTD-filen, vilket f&aring;r &ouml;desdigra
konsekvenser (i form av o&auml;ndliga felmeddelanden). Som tur
&auml;r, s&aring; finns en l&ouml;sning &auml;ven p&aring; detta
problem, n&auml;mligen att vi f&aring;r chansen att prova
p&aring; en <i>inbäddad</i> DTD. Du kopierar helt enkelt all text i
DTD-filen, stryker "SYSTEM xmltest.dtd" i DOCTYPE-deklarationen
och skriver ist&auml;llet in hakparenteser [] och mellan dessa
klistrar du in inneh&aring;llet i DTD-filen.</p>

<p style=
"font-family : arial; font-size : 10pt; background-color : yellow; margin-left: 130px; margin-right : 100px;">
&lt;!DOCTYPE bibliography [<br />
&lt;!ELEMENT bibliography ANY&gt;<br />
&lt;!ELEMENT book (author*, title+, place+, publisher*, year,
pages, edition?, ISBN)&gt;<br />
&lt;!ELEMENT author (#PCDATA)&gt;<br />
&lt;!ELEMENT title (#PCDATA)&gt;<br />
(...)<br />
&lt;!ELEMENT ISBN (#PCDATA)&gt;<br />
]&gt;</p>

<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
D&auml;refter &ouml;ppnar du Brown-validatorn, klickar p&aring;
knappen "Bl&auml;ddra" under "Local file" och letar upp din
XML-fil.</p>

<p style="font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
Om du använder en validerande texteditor (som t ex EditiX eller jEdit) kan du
använda den för giltighetskontroll också (i EditiX kan du göra det genom snabbkommandot [Ctrl - k].
Om du har svårt att tolka de felmeddelanden du får från en tjänst, prova en
annnan.
</p>


<p style=
"font-family : verdana; font-size : 10pt; text-indent : '-1em'; margin-left: 130px; margin-right : 100px;">
<a style="font-family : verdana; font-size : 10pt; color : red;"
href="uppgift1.htm">uppgift 1</a> - <a style=
"font-family : verdana; font-size : 10pt; color : red;" href=
"uppgift3.htm">uppgift 3</a></p>

<hr style="width : '80%'" />
<p style=
"font-family : verdana; color : red; font-size : 8pt; font-style : italic; text-align : center">
Uppdaterad: 2007-03-01<br />
Helena Francke<br />
Reviderad: 2008-04-07, sep 2009<br />
Mikael Gunnarsson</p>

<div style="text-align : center"><a style=
"font-family : verdana; color : red; font-size : 8pt; font-style : italic;"
 href="mailto:helena.francke@hb.se">Helena Francke</a></div>
</body>
</html>


